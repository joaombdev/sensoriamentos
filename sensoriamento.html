<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sensoriamento</title>
</head>

<body>
    <h1>Dados do Firebase</h1>
    <h3>Monitoramento da colmeia</h3>

    <p>Luz: <span id="dados">Carregando...</span></p>
    <p>Peso: <span id="peso">Carregando...</span></p>
    <p>Temperatura: <span id="temp">Carregando...</span></p>
    <p>Umidade: <span id="umidade">Carregando...</span></p>

    <script type="module">
        // Import das funções necessárias
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-database.js";

        // Configurações do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCCmlb-EUSyys7BiBkO2P6bBNNw-5t-ECw",
            authDomain: "bartolomeu84rt.firebaseapp.com",
            databaseURL: "https://bartolomeu84rt-default-rtdb.firebaseio.com",
            projectId: "bartolomeu84rt",
            storageBucket: "bartolomeu84rt.appspot.com",
            messagingSenderId: "922056695451",
            appId: "1:922056695451:web:07068d8e13a17bc193303e"
        };

        // Inicialize o Firebase
        const app = initializeApp(firebaseConfig);

        // Initialize Realtime Database and get a reference to the service
        const database = getDatabase(app);

        // Referência para o endereço no Firebase
        const dbRef = ref(database, '/caixa/luz');
        const pesoRef = ref(database, '/caixa/peso');
        const tempRef = ref(database, '/caixa/temp');
        const umidadeRef = ref(database, '/caixa/umidade');

        // Ler os dados e ouvir mudanças
        onValue(dbRef, (snapshot) => {
            const data = snapshot.val();
            document.getElementById('dados').innerText = JSON.stringify(data, null, 2);
        });

        onValue(pesoRef, (snapshot) => {
            document.getElementById('peso').textContent = snapshot.val() + ' kg';
        });

        onValue(tempRef, (snapshot) => {
            document.getElementById('temp').textContent = snapshot.val() + ' °C';
        });

        onValue(umidadeRef, (snapshot) => {
            document.getElementById('umidade').textContent = snapshot.val() + ' %';
        });
    </script>
</body>

</html>
